---
title: "Sample Exam (Interactive, WebR)"
subtitle: "CourseKata Chapters 1–4"
author: "Mansour Abdoli, PhD"
format:
  live-revealjs:
    slide-number: true
    incremental: true
    chalkboard: true
    preview-links: true
    code-overflow: wrap
    footer: "Sample Exam • CK Ch 1–4"
resources:
  - assets/webr_helpers.R
engine: knitr
execute:
  echo: true
  warning: false
  message: false
output-files: CK-ch1-4-sample-exam-webr.html
---

# Sample Exam (Interactive)

{{< include ./_extensions/r-wasm/live/_knitr.qmd >}}

```{webr}
#| echo: false
#| output: false
#| warning: false
#| message: false

library(mosaic)
library(ggformula)
options(digits = 3)

# Load helper functions if you have them (tally, etc.)
helpers_path <- "assets/webr_helpers.R"
if (file.exists(helpers_path)) {
  helpers <- readLines(helpers_path, warn = FALSE)
  eval(parse(text = helpers))
}

# --- Self-contained datasets used on the exam -------------------------------

# Fingers-style data (for histograms/boxplots)
set.seed(7)
nF <- 90
Fingers <- data.frame(
  Gender = sample(c("Female","Male"), nF, replace = TRUE),
  Thumb  = round(rnorm(nF, mean = 5.8, sd = 0.6), 2),
  Index  = round(rnorm(nF, mean = 7.0, sd = 0.7), 2),
  Middle = round(rnorm(nF, mean = 7.7, sd = 0.7), 2),
  Ring   = round(rnorm(nF, mean = 7.2, sd = 0.7), 2)
)
# add a couple unusual values + some missing
Fingers$Index[sample(1:nF, 2)] <- c(4.9, 9.7)
Fingers$Ring[sample(1:nF, 3)] <- NA

# Numerical-response dataset (Score)
set.seed(123)
nN <- 90
NumData <- data.frame(
  Gender = sample(c("Female","Male"), nN, replace = TRUE),
  StudyTime = round(runif(nN, 0, 10), 1),
  Score = round(60 + 4 * runif(nN, 0, 10) + rnorm(nN, 0, 8), 1)
)

# Categorical-response dataset (Pass/Fail)
set.seed(246)
nC <- 140
CatData <- data.frame(
  Group = sample(c("Control","Treatment"), nC, replace = TRUE),
  StudyTime = round(runif(nC, 0, 10), 1)
)
lin <- -0.8 + 0.35 * CatData$StudyTime + ifelse(CatData$Group == "Treatment", 0.6, 0)
p <- 1 / (1 + exp(-lin))
CatData$Pass <- ifelse(runif(nC) < p, "Pass", "Fail")
CatData$Pass <- factor(CatData$Pass, levels = c("Fail","Pass"))

# A small vector for early questions
x <- c(2, 1, 3, 3, 2, 3, 1, 2, 1)

.webr_ready <- TRUE
```

## Instructions

:::{.nonincremental}
- This is a **practice exam** for Chapters 1–4.
- Work in pairs or solo (your instructor will decide).
- For each question, **run the code** (if provided) and write a short answer.
- If a question asks you to *modify code*, do it in the code cell.
:::

---

# Q1 (Concept): Variation (short answer)

In **1–2 sentences**, define **variation** and explain why variation is central to statistics.

---

# Q2 (Data frame structure)

In **1 sentence each**:

- What do **rows** represent in a data frame?
- What do **columns** represent?

Run:

```{webr}
#| echo: true
#| output: true
head(Fingers, 3)
```

---

# Q3 (Variable types)

Classify each variable as **categorical** or **numerical**:

- `Gender`
- `Index`
- `Group`
- `Score`

Check the structure:

```{webr}
#| echo: true
#| output: true
str(Fingers)
str(NumData)
str(CatData)
```

---

# Q4 (Sorting + tally)

Run the code. Then answer:

1) What pattern is easier to see after sorting?  
2) What does the frequency table make obvious?

```{webr}
#| echo: true
#| output: true
sort(x)
tally(x)
```

---

# Q5 (Histogram: what it shows)

Make a histogram of `Index`. Then answer:

- Describe **shape** (symmetric? skewed? unimodal?)  
- Describe **center** (typical value)  
- Describe **spread** (wide or narrow?)  
- Any **unusual features**?

```{webr}
#| echo: true
#| output: true
gf_histogram(~Index, data = Fingers, binwidth = 0.25)
```

---

# Q6 (Binwidth reasoning)

Make two histograms with different binwidths. Then answer:

- Which one shows “more detail”?  
- Which one shows the “overall pattern” more clearly?

```{webr}
#| echo: true
#| output: true
gf_histogram(~Index, data = Fingers, binwidth = 0.10)
gf_histogram(~Index, data = Fingers, binwidth = 0.50)
```

---

# Q7 (Five-number summary)

Compute a five-number summary for `Index` (ignore missing if any).  
Then explain what **Q1** and **Q3** mean in plain language.

```{webr}
#| echo: true
#| output: true
fivenum(Fingers$Index)
quantile(Fingers$Index, probs = c(.25,.5,.75), na.rm = TRUE)
```

---

# Q8 (IQR + outliers)

Compute the IQR and use the **1.5×IQR rule** to find outliers in `Index`.

```{webr}
#| echo: true
#| output: true
q <- quantile(Fingers$Index, probs = c(.25,.75), na.rm = TRUE)
iqr <- q[2] - q[1]
lower <- q[1] - 1.5 * iqr
upper <- q[2] + 1.5 * iqr
c(IQR = iqr, lower_fence = lower, upper_fence = upper)

Fingers$Index[Fingers$Index < lower | Fingers$Index > upper]
```

**Answer:** Are there outliers? If so, list them.

---

# Q9 (Boxplot: Index by Gender)

Make a side-by-side boxplot and answer:

- Which group has a higher median?  
- Is there a lot of overlap? What does overlap imply about variability?

```{webr}
#| echo: true
#| output: true
gf_boxplot(Index ~ Gender, data = Fingers)
```

---

# Q10 (Missing data)

How many `Ring` values are missing? Then create a version of the dataset with **only non-missing Ring**.

```{webr}
#| echo: true
#| output: true
sum(is.na(Fingers$Ring))

Fingers_noNA <- Fingers[is.na(Fingers$Ring) == FALSE, ]
nrow(Fingers); nrow(Fingers_noNA)
```

---

# Q11 (Response vs explanatory)

For each relationship, identify the **response** and **explanatory** variable:

1) `Score` vs `StudyTime`  
2) `Score` vs `Gender`  
3) `Pass` vs `Group`

---

# Q12 (Choose the right plot)

For each, choose the best plot type and *briefly justify*:

A) numerical response + numerical explanatory  
B) numerical response + categorical explanatory  
C) categorical response + categorical explanatory

---

# Q13 (Scatterplot: Score vs StudyTime)

Make the scatterplot and describe:

- direction (positive/negative/none)  
- strength (weak/moderate/strong)  
- any unusual points

```{webr}
#| echo: true
#| output: true
gf_point(Score ~ StudyTime, data = NumData)
```

---

# Q14 (Boxplot: Score by Gender)

Make the boxplot and interpret it (center/spread/overlap).

```{webr}
#| echo: true
#| output: true
gf_boxplot(Score ~ Gender, data = NumData)
```

---

# Q15 (One-number model)

Compute the overall mean Score.  
Interpret it as a **simple model** (what does it “predict”?).

```{webr}
#| echo: true
#| output: true
overall_mean <- mean(NumData$Score)
overall_mean
```

---

# Q16 (Two-number model)

Compute mean Score by Gender.  
Which model is more informative: one-number or two-number? Why?

```{webr}
#| echo: true
#| output: true
group_means <- mean(Score ~ Gender, data = NumData)
group_means
```

---

# Q17 (Residuals: observed − predicted)

Create predicted values using the two-number model and compute residuals.  
Then compute the **mean absolute residual**.

```{webr}
#| echo: true
#| output: true
NumData$Pred2 <- group_means[NumData$Gender]
NumData$Resid2 <- NumData$Score - NumData$Pred2

mean(abs(NumData$Resid2))
```

**Answer:** In 1 sentence, what does a residual measure?

---

# Q18 (Two-way table: counts)

Create a two-way table of counts for Pass by Group.

```{webr}
#| echo: true
#| output: true
T <- table(CatData$Pass, CatData$Group)
T
```

**Answer:** Why can counts be misleading when comparing groups?

---

# Q19 (Conditional proportions)

Convert the table to **within-group proportions** and interpret:

- Which group has the higher pass rate?
- Estimate the difference in pass rates.

```{webr}
#| echo: true
#| output: true
P <- prop.table(T, margin = 2)   # within each Group (columns)
P
c(diff = P["Pass","Treatment"] - P["Pass","Control"])
```

---

# Q20 (Proportion bar chart + explanation)

Make a conditional proportion bar chart and explain how it helps you **explain variability** in the categorical response.

```{webr}
#| echo: true
#| output: true
gf_bar(~Pass, data = CatData, fill = ~Group, position = "fill")
```

**Answer (3–4 sentences):**  
Use the phrase “**conditional distribution**” at least once.

---

# Extra practice (optional)

Try a *small sample* and see how proportions change:

```{webr}
#| echo: true
#| output: true
small <- CatData[sample(1:nrow(CatData), 25), ]
prop.table(table(small$Pass, small$Group), margin = 2)
gf_bar(~Pass, data = small, fill = ~Group, position = "fill")
```
